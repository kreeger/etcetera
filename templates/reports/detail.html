{% extends "root.html" %}
{% load etcetera_tags %}

{% block title %}
   Reports &raquo; {{ object.name }}
{% endblock %}

{% block breadcrumb %}
   <a href="{% url etcetera-home %}">Home</a> &rsaquo;
   <a href="{% url reports-index %}">Reports</a> &rsaquo;
   {{ object.name }}
{% endblock %}

{% block subnav %}
   <ul>
      <li{% if view_type == 'equipmenttypes' %} class="active"{% endif %}>
         <a href="{% url reports-detail object.slug 'equipmenttypes' %}">Equipment</a>
      </li>
      <li{% if view_type == 'departments' %} class="active"{% endif %}>
         <a href="{% url reports-detail object.slug 'departments' %}">Departments</a>
      </li>
   </ul>
{% endblock %}

{% block content %}
<div id="detail">
   <div id="headers">
      <h1>
         {% if object %}
            {{ object.name }}
            {% if object.start_date or object.end_date %}
               <span class="head">
                  {% if object.start_date %}
                     from {{ object.start_date|date }}
                  {% endif %}
                  {% if object.end_date %}
                     to {{ object.end_date|date }}
                  {% endif %}
               </span>
            {% endif %}
         {% else %}
            Creating a new report
         {% endif %}
      </h1>
   </div>

   <div id="actions">
      <h2>Actions</h2>
      {% if user.is_authenticated %}
         <ul>
            <li><a href="{% url reports-edit object.slug %}">edit</a></li>
         </ul>
      {% else %}
         <p>You must be logged in to perform actions on this report.</p>
      {% endif %}
   </div>
   
   {% if view_type == 'equipmenttypes' %}
   <div id="overall-equipment-usage">
      <h2>Overall equipment usage</h2>
      <table class="list">
         <tr>
            <td>Equipment type</td>
            <td>Count</td>
         </tr>
         {% for k,v in eqt_d %}
            <tr>
               <td>{{ k.name }}</td>
               <td>{{ v }}</td>
            </tr>
         {% endfor %}
      </table>
   </div>
   {% endif %}
   
   {% if view_type == 'departments' %}
   <div id="departments">
      <table class="list">
         <tr>
            <td>Department</td>
            <td>Count</td>
         </tr>
         {% for k,v in ou_d %}
            <tr>
               <td>{{ k.name }}</td>
               <td>{{ v }}</td>
            </tr>
         {% endfor %}
      </table>
   </div>
   {% endif %}
</div>
{% endblock %}